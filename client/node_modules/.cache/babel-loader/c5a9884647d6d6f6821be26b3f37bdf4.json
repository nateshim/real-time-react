{"ast":null,"code":"var _jsxFileName = \"/Users/nathanaelshim/Desktop/real-time-react/client/src/ReactEditor.js\";\nimport React, { Component } from 'react';\nimport { Controlled as CodeMirror } from 'react-codemirror2';\nimport Pusher from 'pusher-js';\nimport pushid from 'pushid';\nimport axios from 'axios';\nimport './ReactEditor.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/material.css';\n\nclass ReactEditor extends Component {\n  constructor() {\n    super();\n\n    this.syncUpdates = () => {\n      const data = { ...this.state\n      };\n      axios.post(\"/update-editor\", data).catch(console.error);\n    };\n\n    this.runCode = () => {\n      var _this$iframe$current;\n\n      const {\n        html,\n        css,\n        js\n      } = this.state;\n      const document = (_this$iframe$current = this.iframe.current) === null || _this$iframe$current === void 0 ? void 0 : _this$iframe$current.contentDocument;\n      const documentContents = `\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n        <title>Document</title>\n        <style>\n          ${css}\n        </style>\n      </head>\n      <body>\n        ${html}\n\n        <script type=\"text/javascript\">\n          ${js}\n        </script>\n      </body>\n      </html>\n    `;\n      document.open();\n      document.write(documentContents);\n      document.close();\n    };\n\n    this.state = {\n      id: '',\n      html: '',\n      css: '',\n      js: ''\n    };\n    this.iframe = React.createRef();\n    this.pusher = new Pusher(\"8367995d3f0fa627b261\", {\n      cluster: \"us3\",\n      forceTLS: true\n    });\n    this.channel = this.pusher.subscribe(\"editor\");\n  }\n\n  componentDidUpdate() {\n    this.runCode();\n  }\n\n  componentDidMount() {\n    this.setState({\n      id: pushid()\n    });\n    this.channel.bind(\"code-update\", data => {\n      const {\n        id\n      } = this.state;\n      if (data.id === id) return;\n      this.setState({\n        html: data.html,\n        css: data.css,\n        js: data.js\n      });\n    });\n  }\n\n  render() {\n    const {\n      html,\n      js,\n      css\n    } = this.state;\n    const codeMirrorOptions = {\n      theme: 'material',\n      lineNumbers: true,\n      scrollbarStyle: null,\n      lineWrapping: true\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"section\", {\n      className: \"playground\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"code-editor html-code\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }\n    }, \"HTML\"), /*#__PURE__*/React.createElement(CodeMirror, {\n      value: html,\n      options: {\n        mode: 'htmlmixed',\n        ...codeMirrorOptions\n      },\n      onBeforeChange: (editor, data, html) => {\n        this.setState({\n          html\n        }, () => this.syncUpdates());\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"code-editor css-code\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 13\n      }\n    }, \"CSS\"), /*#__PURE__*/React.createElement(CodeMirror, {\n      value: css,\n      options: {\n        mode: 'css',\n        ...codeMirrorOptions\n      },\n      onBeforeChange: (editor, data, css) => {\n        this.setState({\n          css\n        }, () => this.syncUpdates());\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"code-editor js-code\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"editor-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 13\n      }\n    }, \"JavaScript\"), /*#__PURE__*/React.createElement(CodeMirror, {\n      value: js,\n      options: {\n        mode: 'javascript',\n        ...codeMirrorOptions\n      },\n      onBeforeChange: (editor, data, js) => {\n        this.setState({\n          js\n        }, () => this.syncUpdates());\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"section\", {\n      className: \"result\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"iframe\", {\n      title: \"result\",\n      className: \"iframe\",\n      ref: this.iframe,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nexport default ReactEditor;","map":{"version":3,"sources":["/Users/nathanaelshim/Desktop/real-time-react/client/src/ReactEditor.js"],"names":["React","Component","Controlled","CodeMirror","Pusher","pushid","axios","ReactEditor","constructor","syncUpdates","data","state","post","catch","console","error","runCode","html","css","js","document","iframe","current","contentDocument","documentContents","open","write","close","id","createRef","pusher","cluster","forceTLS","channel","subscribe","componentDidUpdate","componentDidMount","setState","bind","render","codeMirrorOptions","theme","lineNumbers","scrollbarStyle","lineWrapping","mode","editor"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { Controlled as CodeMirror } from 'react-codemirror2';\nimport Pusher from 'pusher-js';\nimport pushid from 'pushid';\nimport axios from 'axios';\nimport './ReactEditor.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'codemirror/theme/material.css';\n\nclass ReactEditor extends Component {\n  constructor() {\n    super();\n    this.state = {\n      id: '',\n      html: '',\n      css: '',\n      js: '',\n    };\n    this.iframe = React.createRef();\n    this.pusher = new Pusher(\"8367995d3f0fa627b261\", {\n      cluster: \"us3\",\n      forceTLS: true\n    });\n\n    this.channel = this.pusher.subscribe(\"editor\");\n  }\n\n  componentDidUpdate() {\n    this.runCode();\n  }\n\n  componentDidMount() {\n    this.setState({\n      id: pushid(),\n    });\n\n    this.channel.bind(\"code-update\", data => {\n      const { id } = this.state;\n      if (data.id === id) return;\n\n      this.setState({\n        html: data.html,\n        css: data.css,\n        js: data.js,\n      });\n    });\n  }\n\n  syncUpdates = () => {\n    const data = { ...this.state };\n\n    axios\n      .post(\"/update-editor\", data)\n      .catch(console.error);\n  };\n\n  runCode = () => {\n    const { html, css, js } = this.state;\n    const document = this.iframe.current?.contentDocument;\n    const documentContents = `\n      <!DOCTYPE html>\n      <html lang=\"en\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"ie=edge\">\n        <title>Document</title>\n        <style>\n          ${css}\n        </style>\n      </head>\n      <body>\n        ${html}\n\n        <script type=\"text/javascript\">\n          ${js}\n        </script>\n      </body>\n      </html>\n    `;\n\n    document.open();\n    document.write(documentContents);\n    document.close();\n  };\n\n  render() {\n    const { html, js, css } = this.state;\n    const codeMirrorOptions = {\n      theme: 'material',\n      lineNumbers: true,\n      scrollbarStyle: null,\n      lineWrapping: true,\n    };\n\n    return (\n      <div className=\"App\">\n        <section className=\"playground\">\n          <div className=\"code-editor html-code\">\n            <div className=\"editor-header\">HTML</div>\n            <CodeMirror\n              value={html}\n              options={{\n                mode: 'htmlmixed',\n                ...codeMirrorOptions,\n              }}\n              onBeforeChange={(editor, data, html) => {\n                this.setState({ html }, () => this.syncUpdates());\n              }}\n            />\n          </div>\n          <div className=\"code-editor css-code\">\n            <div className=\"editor-header\">CSS</div>\n            <CodeMirror\n              value={css}\n              options={{\n                mode: 'css',\n                ...codeMirrorOptions,\n              }}\n              onBeforeChange={(editor, data, css) => {\n                this.setState({ css }, () => this.syncUpdates());\n              }}\n            />\n          </div>\n          <div className=\"code-editor js-code\">\n            <div className=\"editor-header\">JavaScript</div>\n            <CodeMirror\n              value={js}\n              options={{\n                mode: 'javascript',\n                ...codeMirrorOptions,\n              }}\n              onBeforeChange={(editor, data, js) => {\n                this.setState({ js }, () => this.syncUpdates());\n              }}\n            />\n          </div>\n        </section>\n        <section className=\"result\">\n          <iframe title=\"result\" className=\"iframe\" ref={this.iframe} />\n        </section>\n      </div>\n    );\n  }\n}\n\nexport default ReactEditor;\n"]},"metadata":{},"sourceType":"module"}