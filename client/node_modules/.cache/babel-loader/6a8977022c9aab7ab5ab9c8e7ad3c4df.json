{"ast":null,"code":"var _jsxFileName = \"/Users/nathanaelshim/Desktop/real-time-react/client/src/App.js\";\nimport React, { Component, useRef, useEffect, useState } from 'react';\nimport { PixelEditor, Pencil } from '@curtishughes/pixel-editor';\nimport Pusher from 'pusher-js';\nimport pushid from 'pushid';\nimport axios from 'axios';\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    this.syncUpdates = () => {\n      const data = { ...this.state\n      };\n      axios.post(\"/update-editor\", data).catch(console.error);\n    };\n\n    this.runCode = () => {\n      var _this$editorRef$curre;\n\n      const {\n        editor\n      } = this.state;\n      const document = (_this$editorRef$curre = this.editorRef.current) === null || _this$editorRef$curre === void 0 ? void 0 : _this$editorRef$curre.contentDocument;\n      const documentContents = `\n          ${editor}\n        `;\n      document.open();\n      document.write(documentContents);\n      document.close();\n    };\n\n    this.state = {\n      id: '',\n      editor: null\n    };\n    this.editorRef = React.createRef();\n    this.pusher = new Pusher(\"8367995d3f0fa627b261\", {\n      cluster: \"us3\",\n      forceTLS: true\n    });\n    this.channel = this.pusher.subscribe(\"editor\");\n  }\n\n  componentDidMount() {\n    if (this.editorRef.current) {\n      this.setState({\n        editor: new PixelEditor(this.editorRef.current, 64, 64, new Pencil('black'))\n      });\n    }\n\n    this.setState({\n      id: pushid()\n    });\n    this.channel.bind(\"code-update\", data => {\n      const {\n        id\n      } = this.state;\n      if (data.id === id) return;\n      this.setState({\n        editor: data.editor\n      });\n    });\n  }\n\n  componentDidUpdate() {\n    this.runCode();\n  }\n\n  render() {\n    const {\n      editor\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"canvas\", {\n      onClick: editor => {\n        editor.persist();\n        this.setState({\n          editor\n        }, () => this.syncUpdates());\n      },\n      ref: this.editorRef,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => {\n        if (editor) editor.tool = new Pencil();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }\n    }, \"Eraser\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => {\n        if (editor) editor.tool = new Pencil('black');\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }\n    }, \"Pencil\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => {\n        if (editor) editor.undo();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }\n    }, \"Undo\"), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: () => {\n        if (editor) editor.redo();\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }\n    }, \"Redo\"));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/nathanaelshim/Desktop/real-time-react/client/src/App.js"],"names":["React","Component","useRef","useEffect","useState","PixelEditor","Pencil","Pusher","pushid","axios","App","constructor","syncUpdates","data","state","post","catch","console","error","runCode","editor","document","editorRef","current","contentDocument","documentContents","open","write","close","id","createRef","pusher","cluster","forceTLS","channel","subscribe","componentDidMount","setState","bind","componentDidUpdate","render","persist","tool","undo","redo"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,SAAnC,EAA8CC,QAA9C,QAA8D,OAA9D;AACA,SAASC,WAAT,EAAsBC,MAAtB,QAAoC,4BAApC;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,MAAMC,GAAN,SAAkBT,SAAlB,CAA4B;AACxBU,EAAAA,WAAW,GAAG;AACV;;AADU,SAmCdC,WAnCc,GAmCA,MAAM;AAChB,YAAMC,IAAI,GAAG,EACT,GAAG,KAAKC;AADC,OAAb;AAGAL,MAAAA,KAAK,CACJM,IADD,CACM,gBADN,EACwBF,IADxB,EAECG,KAFD,CAEOC,OAAO,CAACC,KAFf;AAGH,KA1Ca;;AAAA,SA2CdC,OA3Cc,GA2CJ,MAAM;AAAA;;AACZ,YAAM;AAAEC,QAAAA;AAAF,UAAa,KAAKN,KAAxB;AACA,YAAMO,QAAQ,4BAAG,KAAKC,SAAL,CAAeC,OAAlB,0DAAG,sBAAwBC,eAAzC;AACA,YAAMC,gBAAgB,GAAI;YACtBL,MAAO;SADX;AAIAC,MAAAA,QAAQ,CAACK,IAAT;AACAL,MAAAA,QAAQ,CAACM,KAAT,CAAeF,gBAAf;AACAJ,MAAAA,QAAQ,CAACO,KAAT;AACD,KArDW;;AAEV,SAAKd,KAAL,GAAa;AACXe,MAAAA,EAAE,EAAE,EADO;AAEXT,MAAAA,MAAM,EAAG;AAFE,KAAb;AAIA,SAAKE,SAAL,GAAiBtB,KAAK,CAAC8B,SAAN,EAAjB;AACA,SAAKC,MAAL,GAAc,IAAIxB,MAAJ,CAAW,sBAAX,EAAmC;AAC/CyB,MAAAA,OAAO,EAAE,KADsC;AAE/CC,MAAAA,QAAQ,EAAE;AAFqC,KAAnC,CAAd;AAIA,SAAKC,OAAL,GAAe,KAAKH,MAAL,CAAYI,SAAZ,CAAsB,QAAtB,CAAf;AACH;;AACDC,EAAAA,iBAAiB,GAAG;AAChB,QAAI,KAAKd,SAAL,CAAeC,OAAnB,EAA4B;AACxB,WAAKc,QAAL,CAAc;AACVjB,QAAAA,MAAM,EAAG,IAAIf,WAAJ,CAAgB,KAAKiB,SAAL,CAAeC,OAA/B,EAAwC,EAAxC,EAA4C,EAA5C,EAAgD,IAAIjB,MAAJ,CAAW,OAAX,CAAhD;AADC,OAAd;AAGH;;AACD,SAAK+B,QAAL,CAAc;AACZR,MAAAA,EAAE,EAAErB,MAAM;AADE,KAAd;AAIA,SAAK0B,OAAL,CAAaI,IAAb,CAAkB,aAAlB,EAAiCzB,IAAI,IAAI;AACvC,YAAM;AAAEgB,QAAAA;AAAF,UAAS,KAAKf,KAApB;AACA,UAAID,IAAI,CAACgB,EAAL,KAAYA,EAAhB,EAAoB;AAEpB,WAAKQ,QAAL,CAAc;AACZjB,QAAAA,MAAM,EAAEP,IAAI,CAACO;AADD,OAAd;AAGD,KAPD;AAQH;;AACDmB,EAAAA,kBAAkB,GAAG;AACjB,SAAKpB,OAAL;AACH;;AAqBDqB,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEpB,MAAAA;AAAF,QAAa,KAAKN,KAAxB;AACA,wBACI,uDACA;AAAQ,MAAA,OAAO,EAAGM,MAAD,IAAY;AACzBA,QAAAA,MAAM,CAACqB,OAAP;AACA,aAAKJ,QAAL,CAAc;AAAEjB,UAAAA;AAAF,SAAd,EAA0B,MAAM,KAAKR,WAAL,EAAhC;AACD,OAHH;AAGK,MAAA,GAAG,EAAE,KAAKU,SAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,eAKI;AAAQ,MAAA,OAAO,EAAE,MAAM;AAAE,YAAIF,MAAJ,EAAYA,MAAM,CAACsB,IAAP,GAAc,IAAIpC,MAAJ,EAAd;AAA4B,OAAjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALJ,eAMI;AAAQ,MAAA,OAAO,EAAE,MAAM;AAAE,YAAIc,MAAJ,EAAYA,MAAM,CAACsB,IAAP,GAAc,IAAIpC,MAAJ,CAAW,OAAX,CAAd;AAAmC,OAAxE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBANJ,eAOI;AAAQ,MAAA,OAAO,EAAE,MAAM;AAAE,YAAIc,MAAJ,EAAYA,MAAM,CAACuB,IAAP;AAAe,OAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAPJ,eAQI;AAAQ,MAAA,OAAO,EAAE,MAAM;AAAE,YAAIvB,MAAJ,EAAYA,MAAM,CAACwB,IAAP;AAAe,OAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cARJ,CADJ;AAYH;;AAtEuB;;AAyE5B,eAAelC,GAAf","sourcesContent":["import React, { Component, useRef, useEffect, useState } from 'react';\nimport { PixelEditor, Pencil } from '@curtishughes/pixel-editor';\nimport Pusher from 'pusher-js';\nimport pushid from 'pushid';\nimport axios from 'axios';\n \nclass App extends Component {\n    constructor() {\n        super();\n        this.state = {\n          id: '',\n          editor : null,\n        };\n        this.editorRef = React.createRef();\n        this.pusher = new Pusher(\"8367995d3f0fa627b261\", {\n          cluster: \"us3\",\n          forceTLS: true\n        });\n        this.channel = this.pusher.subscribe(\"editor\");\n    }\n    componentDidMount() {\n        if (this.editorRef.current) {\n            this.setState({\n                editor : new PixelEditor(this.editorRef.current, 64, 64, new Pencil('black')),\n            }) \n        }\n        this.setState({\n          id: pushid(),\n        });\n    \n        this.channel.bind(\"code-update\", data => {\n          const { id } = this.state;\n          if (data.id === id) return;\n\n          this.setState({\n            editor: data.editor,\n          });\n        });\n    }\n    componentDidUpdate() {\n        this.runCode();\n    }\n    syncUpdates = () => {\n        const data = { \n            ...this.state\n        };\n        axios\n        .post(\"/update-editor\", data)\n        .catch(console.error);\n    };\n    runCode = () => {\n        const { editor } = this.state;\n        const document = this.editorRef.current?.contentDocument;\n        const documentContents = `\n          ${editor}\n        `;\n    \n        document.open();\n        document.write(documentContents);\n        document.close();\n      };\n    \n    render() {\n        const { editor } = this.state;\n        return (\n            <>\n            <canvas onClick={(editor) => {\n                editor.persist();\n                this.setState({ editor }, () => this.syncUpdates());\n              }} ref={this.editorRef} />\n                <button onClick={() => { if (editor) editor.tool = new Pencil() }}>Eraser</button>\n                <button onClick={() => { if (editor) editor.tool = new Pencil('black') }}>Pencil</button>\n                <button onClick={() => { if (editor) editor.undo() }}>Undo</button>\n                <button onClick={() => { if (editor) editor.redo() }}>Redo</button>\n            </>\n        );\n    }\n}\n \nexport default App;"]},"metadata":{},"sourceType":"module"}